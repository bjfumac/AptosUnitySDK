{"version":3,"sources":["/Users/yomob/Documents/GitHub/AptosUnitySDK/Unity/TS/src/DeveloperTools.ts"],"sourcesContent":["const System:any = CS.System;\nconst Puerts:any = CS.Puerts;\nconst UnityEngine:any = CS.UnityEngine;\n\n// HotReload 端口号存储\n((puer:any)=>{\n    const jsEnvs:any = Puerts.JsEnv.jsEnvs;\n    const debugPorts = (()=>{\n        let result = '';\n        for(let i=0,len=jsEnvs.Count; i<len; i++){\n            const item = jsEnvs.get_Item(i);\n            if(item && item.debugPort !== -1){\n                result += `${item.debugPort},`;\n            };\n        };\n        if(result.length){\n            result = result.slice(0,-1);\n        };\n        return result;\n    })();\n    const path = System.IO.Path.Combine(UnityEngine.Application.dataPath,'.puertsVmDebugPorts.txt');\n    const sw = new System.IO.StreamWriter(path);\n    sw.Write(debugPorts);\n    sw.Flush();\n    sw.Close();\n})(global.puer);\n\n// SourceMaps 支持\n((puer:any)=>{\n    // 增加 path、fs 模块支持\n    puer.registerBuildinModule('path', {\n        dirname(path) {\n            return System.IO.Path.GetDirectoryName(path);\n        },\n        resolve(dir, url) {\n            url = url.replace(/\\\\/g, '/');\n            while (url.startsWith('../')) {\n                dir = System.IO.Path.GetDirectoryName(dir);\n                url = url.substr(3);\n            }\n            return System.IO.Path.Combine(dir, url);\n        },\n    });\n    puer.registerBuildinModule('fs', {\n        existsSync(path) {\n            return System.IO.File.Exists(path);\n        },\n        readFileSync(path) {\n            return System.IO.File.ReadAllText(path);\n        },\n    });\n    \n    // 由于目前 puerts 版本引入 node_modules 不支持 import 方式，并且 source-map-support 扩展依赖 fs、path 模块\n    const sourceMapSupport = require('source-map-support');\n\n    // 处理文件关系（source-map-support） 依赖上面的文件\n    sourceMapSupport.install({\n        retrieveSourceMap:function(source){\n            let mapFile = source+'.map';\n            if (System.IO.File.Exists(mapFile)) {\n                return {\n                    url: source,\n                    map: System.IO.File.ReadAllText(mapFile)\n                };\n            };\n            return null;\n        }\n    });\n})(global.puer);\n"],"names":["System","CS","Puerts","UnityEngine","puer","jsEnvs","JsEnv","debugPorts","result","i","len","Count","item","get_Item","debugPort","length","slice","path","IO","Path","Combine","Application","dataPath","sw","StreamWriter","Write","Flush","Close","global","registerBuildinModule","dirname","GetDirectoryName","resolve","dir","url","replace","startsWith","substr","existsSync","File","Exists","readFileSync","ReadAllText","sourceMapSupport","require","install","retrieveSourceMap","source","mapFile","map"],"mappings":"AAAA,MAAMA,SAAaC,GAAGD,MAAM;AAC5B,MAAME,SAAaD,GAAGC,MAAM;AAC5B,MAAMC,cAAkBF,GAAGE,WAAW;AAEtC,kBAAkB;AACjB,CAAA,CAACC,OAAW;IACT,MAAMC,SAAaH,OAAOI,KAAK,CAACD,MAAM;IACtC,MAAME,aAAa,AAAC,CAAA,IAAI;QACpB,IAAIC,SAAS;QACb,IAAI,IAAIC,IAAE,GAAEC,MAAIL,OAAOM,KAAK,EAAEF,IAAEC,KAAKD,IAAI;YACrC,MAAMG,OAAOP,OAAOQ,QAAQ,CAACJ;YAC7B,IAAGG,QAAQA,KAAKE,SAAS,KAAK,CAAC,GAAE;gBAC7BN,UAAU,CAAC,EAAEI,KAAKE,SAAS,CAAC,CAAC,CAAC;YAClC,CAAC;QACL;QACA,IAAGN,OAAOO,MAAM,EAAC;YACbP,SAASA,OAAOQ,KAAK,CAAC,GAAE,CAAC;QAC7B,CAAC;QACD,OAAOR;IACX,CAAA;IACA,MAAMS,OAAOjB,OAAOkB,EAAE,CAACC,IAAI,CAACC,OAAO,CAACjB,YAAYkB,WAAW,CAACC,QAAQ,EAAC;IACrE,MAAMC,KAAK,IAAIvB,OAAOkB,EAAE,CAACM,YAAY,CAACP;IACtCM,GAAGE,KAAK,CAAClB;IACTgB,GAAGG,KAAK;IACRH,GAAGI,KAAK;AACZ,CAAA,EAAGC,OAAOxB,IAAI;AAEd,gBAAgB;AACf,CAAA,CAACA,OAAW;IACT,kBAAkB;IAClBA,KAAKyB,qBAAqB,CAAC,QAAQ;QAC/BC,SAAQb,IAAI,EAAE;YACV,OAAOjB,OAAOkB,EAAE,CAACC,IAAI,CAACY,gBAAgB,CAACd;QAC3C;QACAe,SAAQC,GAAG,EAAEC,GAAG,EAAE;YACdA,MAAMA,IAAIC,OAAO,CAAC,OAAO;YACzB,MAAOD,IAAIE,UAAU,CAAC,OAAQ;gBAC1BH,MAAMjC,OAAOkB,EAAE,CAACC,IAAI,CAACY,gBAAgB,CAACE;gBACtCC,MAAMA,IAAIG,MAAM,CAAC;YACrB;YACA,OAAOrC,OAAOkB,EAAE,CAACC,IAAI,CAACC,OAAO,CAACa,KAAKC;QACvC;IACJ;IACA9B,KAAKyB,qBAAqB,CAAC,MAAM;QAC7BS,YAAWrB,IAAI,EAAE;YACb,OAAOjB,OAAOkB,EAAE,CAACqB,IAAI,CAACC,MAAM,CAACvB;QACjC;QACAwB,cAAaxB,IAAI,EAAE;YACf,OAAOjB,OAAOkB,EAAE,CAACqB,IAAI,CAACG,WAAW,CAACzB;QACtC;IACJ;IAEA,oFAAoF;IACpF,MAAM0B,mBAAmBC,QAAQ;IAEjC,qCAAqC;IACrCD,iBAAiBE,OAAO,CAAC;QACrBC,mBAAkB,SAASC,MAAM,EAAC;YAC9B,IAAIC,UAAUD,SAAO;YACrB,IAAI/C,OAAOkB,EAAE,CAACqB,IAAI,CAACC,MAAM,CAACQ,UAAU;gBAChC,OAAO;oBACHd,KAAKa;oBACLE,KAAKjD,OAAOkB,EAAE,CAACqB,IAAI,CAACG,WAAW,CAACM;gBACpC;YACJ,CAAC;YACD,OAAO,IAAI;QACf;IACJ;AACJ,CAAA,EAAGpB,OAAOxB,IAAI"}