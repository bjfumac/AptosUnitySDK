{"version":3,"sources":["/Users/yomob/Documents/GitHub/AptosUnitySDK/Unity/TS/src/App.ts"],"sourcesContent":["import ue = CS.UnityEngine;                                                                         // 是用来协助进行类型检查和声明的，在运行时是完全不存在\nimport Ticker from './Core/Ticker';\nimport TestSendCoin from \"./Example/TransferCoin\";\nconst { GameObject, Vector2, Vector3, RenderMode, Camera, Canvas,\n    LightType, FontStyle, UI, CameraClearFlags, EventSystems,\n     TextAnchor, LightmapBakeType} = CS.UnityEngine;\nconst {CanvasScaler} = CS.UnityEngine.UI;\n\nconst {$typeof} = puer;\n\nnamespace Game {\n    interface GameOption {\n        maxFps?:number,\n        online?:boolean\n    }\n    interface GameObj {\n        object:ue.GameObject,\n        components?:{\n            camera?:ue.Camera,\n            canvas?:ue.Canvas,\n            canvaslScale?:ue.UI.CanvasScaler,\n            graphicRaycaster?:ue.UI.GraphicRaycaster\n            eventSystem?:ue.EventSystems.EventSystem,\n            standaloneInputModule?:ue.EventSystems.StandaloneInputModule,\n            text?:ue.UI.Text,\n            rectTransform?:ue.RectTransform,\n            slider?:ue.UI.Slider\n        }\n    }\n\n    export class App{\n        private _maxFps:number;                                                                     \n        private ticker:Ticker;\n        public static mainCamera:ue.GameObject;\n        public static uiCamera:ue.GameObject;\n        public static uiCanvas:ue.GameObject;\n        public static eventSystem:ue.GameObject;\n        public static stage:ue.GameObject;\n\n\n        constructor(option?:GameOption){\n            if(option){\n                for(let key in option){\n                    this[key] = option[key];\n                };\n            };\n            if(!this.MaxFps){\n                this.MaxFps = 60;\n            };\n            if(!this.MaxFps){\n                this.MaxFps = 60;\n            };\n            this.ticker = new Ticker(this.MaxFps);                                                  \n        }\n\n        /**\n         * Entry\n         */\n        async init():Promise<void>{\n            this.ticker.start();\n            \n            const mainCameraObj = this.CreateMainCamera();\n            App.mainCamera = mainCameraObj.object;\n            \n            const uiCameraObj = this.CreateUiCamera();\n            App.uiCamera = uiCameraObj.object;\n            \n            const canvasObj = this.CreateCanvas(uiCameraObj.components.camera);\n            App.uiCanvas = canvasObj.object;\n            \n            const eventSystemObj = this.CreateEventSystem();\n            App.eventSystem = eventSystemObj.object;\n            \n            App.stage = new GameObject(\"Stage\");\n           \n            Ticker.add(this.OnUpdate);   \n                 \n            this.TestAptos();\n        }\n\n        /**\n         * Test Aptos API here\n         */\n        TestAptos(){\n            // Test Send Coin\n            const testSendCoin = new TestSendCoin();\n            testSendCoin.test();\n        }\n\n        /**\n         * Update Function\n         * @param deltaTime \n         * @param realtimeSinceStartup \n         */\n        OnUpdate(deltaTime:number,realtimeSinceStartup:number){\n                \n        };\n       \n\n        \n\n        set MaxFps(val:number){\n            this._maxFps = val;\n        }\n        get MaxFps():number{\n            return this._maxFps;\n        }\n\n       \n        CreateMainCamera():GameObj{\n            const object:ue.GameObject = new GameObject(\"Main Camera\");\n            let camera:ue.Camera = object.AddComponent($typeof(Camera)) as ue.Camera;\n            camera.clearFlags = CameraClearFlags.Skybox;\n            camera.cullingMask = ~(1 << 5);                                                        \n            camera.nearClipPlane = 2;\n            camera.farClipPlane = 40;\n            camera.transform.Rotate(20,0,0);\n            camera.transform.localScale = new Vector3(0.5,0.5,0.5);\n            camera.transform.localPosition = new Vector3(0,7,-20);\n            return {object,components:{camera}};\n        }\n\n        CreateUiCamera():GameObj{\n            const object:ue.GameObject = new GameObject(\"Ui Camera\");\n            object.transform.position = new Vector3(-10,0,0);\n            const camera:ue.Camera = object.AddComponent($typeof(Camera)) as ue.Camera;\n            camera.clearFlags = CameraClearFlags.Depth;\n            camera.cullingMask = 1 << 5;                                                            \n            camera.orthographic = true; \n            camera.nearClipPlane = 5;\n            camera.farClipPlane = 15;\n            return {object,components:{camera}};\n        }\n\n     \n        CreateCanvas(cameraComponent:ue.Camera):GameObj{\n            const object:ue.GameObject = new GameObject(\"Canvas\");\n            object.layer = 5;                                                                      \n            const canvas:ue.Canvas = object.AddComponent($typeof(Canvas)) as ue.Canvas;\n            canvas.renderMode = RenderMode.ScreenSpaceCamera;\n            canvas.worldCamera = cameraComponent;\n            canvas.planeDistance = 10;\n            const canvaslScale:ue.UI.CanvasScaler = object.AddComponent($typeof(CanvasScaler)) as ue.UI.CanvasScaler;\n            canvaslScale.uiScaleMode = CanvasScaler.ScaleMode.ScaleWithScreenSize;\n            canvaslScale.referenceResolution = new Vector2(428,926);\n            canvaslScale.matchWidthOrHeight = 1;\n            const graphicRaycaster = object.AddComponent($typeof(UI.GraphicRaycaster)) as ue.UI.GraphicRaycaster;\n            return {object,components:{canvas,canvaslScale,graphicRaycaster}};\n        }\n\n        /**\n         * 创建UI事件系统\n         * @returns object\n         */\n        CreateEventSystem():GameObj{\n            const object:ue.GameObject = new GameObject(\"EventSystem\");\n            const eventSystem = object.AddComponent($typeof(EventSystems.EventSystem)) as ue.EventSystems.EventSystem;\n            const standaloneInputModule = object.AddComponent($typeof(EventSystems.StandaloneInputModule)) as ue.EventSystems.StandaloneInputModule;\n            return {object,components:{eventSystem,standaloneInputModule}};\n        }\n    }\n}\n(()=>{\n    const app = new Game.App({maxFps:60,online:false});\n    app.init();\n})()\nexport default Game.App;"],"names":["Ticker","TestSendCoin","GameObject","Vector2","Vector3","RenderMode","Camera","Canvas","LightType","FontStyle","UI","CameraClearFlags","EventSystems","TextAnchor","LightmapBakeType","CS","UnityEngine","CanvasScaler","$typeof","puer","Game","App","init","ticker","start","mainCameraObj","CreateMainCamera","mainCamera","object","uiCameraObj","CreateUiCamera","uiCamera","canvasObj","CreateCanvas","components","camera","uiCanvas","eventSystemObj","CreateEventSystem","eventSystem","stage","add","OnUpdate","TestAptos","testSendCoin","test","deltaTime","realtimeSinceStartup","MaxFps","val","_maxFps","AddComponent","clearFlags","Skybox","cullingMask","nearClipPlane","farClipPlane","transform","Rotate","localScale","localPosition","position","Depth","orthographic","cameraComponent","layer","canvas","renderMode","ScreenSpaceCamera","worldCamera","planeDistance","canvaslScale","uiScaleMode","ScaleMode","ScaleWithScreenSize","referenceResolution","matchWidthOrHeight","graphicRaycaster","GraphicRaycaster","EventSystem","standaloneInputModule","StandaloneInputModule","constructor","option","key","app","maxFps","online"],"mappings":"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"}